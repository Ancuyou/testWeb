<th:block th:replace="~{pages/admin/layout :: layout(~{::department_add_content}, 'departments')}">
    <th:block th:fragment="department_add_content">
        <div class="container py-3">
            <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
                <h2 class="h4 mb-0">
                    <i class="fas fa-building me-2"></i>Thêm khoa/ngành
                </h2>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">
                    <form th:action="@{/admin/department/insert}" method="post" onsubmit="return validateForm()">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="departmentName" class="form-label fw-semibold">
                                    <i class="fas fa-tag me-1 text-primary"></i>Tên khoa/ngành <span class="text-danger">*</span>
                                </label>
                                <input type="text"
                                       class="form-control"
                                       id="departmentName"
                                       name="departmentName"
                                       th:value="${department.departmentName}"
                                       maxlength="100"
                                       required
                                       placeholder="Nhập tên khoa/ngành">
                            </div>

                            <div class="col-md-6">
                                <label for="type" class="form-label fw-semibold">
                                    <i class="fas fa-layer-group me-1 text-primary"></i>Loại <span class="text-danger">*</span>
                                </label>
                                <select id="type" name="type" class="form-select" required>
                                    <option th:each="t : ${T(it.ute.QAUTE.entity.Department.DepartmentType).values()}"
                                            th:value="${t}"
                                            th:text="${t}"
                                            th:selected="${t} == ${department.type}">
                                    </option>
                                </select>
                            </div>

                            <div class="col-md-6">
                                <label for="parent" class="form-label fw-semibold">
                                    <i class="fas fa-sitemap me-1 text-primary"></i>Trực thuộc (Khoa)
                                </label>
                                <select id="parent" name="parent.departmentID" class="form-select">
                                    <option th:value="${null}" th:text="'-- Không có --'"
                                            th:selected="${department.parent == null}"></option>
                                    <option th:each="p : ${allDepartments}"
                                            th:if="${p.departmentID != department.departmentID}"
                                    th:value="${p.departmentID}"
                                    th:text="${p.departmentName}"
                                    th:selected="${department.parent != null} ? ${p.departmentID} == ${department.parent.departmentID} : false">
                                    </option>
                                </select>
                            </div>

                            <!-- Description -->
                            <div class="col-12">
                                <label for="description" class="form-label fw-semibold">
                                    <i class="fas fa-align-left me-1 text-primary"></i>Mô tả
                                </label>
                                <textarea id="description"
                                          name="description"
                                          class="form-control"
                                          rows="4"
                                          th:text="${department.description}"
                                          placeholder="Mô tả ngắn về khoa/ban..."></textarea>
                            </div>
                        </div>

                        <!-- Actions -->
                        <div class="d-flex justify-content-between mt-4">
                            <a th:href="@{/admin/departments}" class="btn btn-secondary">
                                <i class="fas fa-times me-1"></i>Hủy
                            </a>
                            <button type="submit" class="btn btn-primary" id="submitBtn">
                                <i class="fas fa-save me-1"></i>Lưu thay đổi
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <script>
            function validateForm() {
                const name = document.getElementById('departmentName').value.trim();
                if (!name) { alert('Vui lòng nhập Tên khoa/ban'); return false; }
                const btn = document.getElementById('submitBtn');
                btn.disabled = true; btn.classList.add('disabled');
                return true;
            }
        </script>
    </th:block>
</th:block>
